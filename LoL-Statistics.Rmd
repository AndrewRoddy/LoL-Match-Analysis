---
title: "LoL-Statistics"
author: "Andrew Roddy"
date: "2025-11-24"
output: pdf_document
---

### MatchStatsTbl.csv

Import code and print off column and row count
```{r import}
match_stats <- read.csv("data/MatchStatsTbl.csv")
row_count <- nrow(match_stats)
col_count <- ncol(match_stats)
cat("There are", row_count, "rows.\n")
cat("There are", col_count, "columns.\n")

team_stats <- read.csv("data/TeamMatchTbl.csv")
row_count2 <- nrow(team_stats)
col_count2 <- ncol(team_stats)
cat("There are", row_count2, "rows.\n")
cat("There are", col_count2, "columns.\n")
```

```{r clean}

# Removes unimportant columns of data
match_stats[, c(
  "item1", "item2", "item3", "item4", "item5", "item6",
  "PrimarySlot1", "PrimarySlot2", "PrimarySlot3",
  "SecondarySlot1", "SecondarySlot2",
  "SummonerSpell1", "SummonerSpell2"
)] <- list(NULL)

names <- colnames(match_stats)
print(names)
```

Multiple regression to test if 
```{r sort and cycle}

library(ggplot2)
library(scales)
library(car)

# make simple regression model
multiple_regression <- lm(DmgDealt ~
    DmgTaken + TotalGold + MinionsKilled + TurretDmgDealt +
      CurrentMasteryPoints,
  data = match_stats
)
# Print off if this matters or not
summary(multiple_regression)

# Creates the variable plots
# #000000 point color
# 0.01 : 1 percent opacity

# Commented out for now
avPlots(multiple_regression, col = alpha("#000000", 0.02))
```

```{r 2WayANOVA}
#KEYSTONE KEY
#8465 - Guardian
#8214 - SummonAery
#8112 - Electrocute
#0 - MissingData?
#8128 - Dark Harvest
#8010 - Conquerer
#8229 - ArcaneComet
#8369 - FirstStrike
#8008 - LethalTempo
#8005 - PressTheAttack
#8439 - Afterschock
#8230 - PhaseRush
#9923 - HailOfBlades
#8021 - FleetFootwork
#8351 - GlacialAugment
#8437 - GraspOfTheUndying
#8360 - UnsealedSpellbook
#Remove outliers
dmgDealt <- match_stats$DmgDealt
Q1 <- quantile(dmgDealt, 0.25)
Q3 <- quantile(dmgDealt, 0.75)
IQR <- Q3 - Q1

lowerBound <- Q1 - 1.5 * IQR
upperBound <- Q3 + 1.5 * IQR

filtered <- match_stats[dmgDealt >= lowerBound & dmgDealt <= upperBound & match_stats$PrimaryKeyStone != '0' & match_stats$Lane != "NONE", ]

#2 Way ANOVA on Keystone and Role
filtered$PrimaryKeyStone = factor(filtered$PrimaryKeyStone)
filtered$Lane = factor(filtered$Lane)
model = aov(DmgDealt ~ PrimaryKeyStone * Lane, data=filtered)
summary(model)
#Results show a high F value meaning that KeyStone has a large effect on average damage even with the large amount of noise (random player variation still makes most of the difference)
#P-Values all very low so all very signifigant
#Residuals are very high, meaning that KeyStone and Lane are primarily not the biggest effects and most is left up to other factors(Likely player randomness and maybe gold earned)

#Find Individual stats
KeyStoneStats = TukeyHSD(model, "PrimaryKeyStone")
KeyStoneStats
LaneStats = TukeyHSD(model, "Lane")
LaneStats
#NEED TO DO: GRAPH AND VISULIZE DATA PROPERLY
```

```{r Team Logistic Regression}
#Logistic Regression on a bunch of team Data
blueBarons = team_stats$BlueBaronKills
blueDragons = team_stats$BlueDragonKills
blueHeralds = team_stats$BlueRiftHeraldKills
blueKills = team_stats$BlueKills

model = glm(BlueWin ~ blueBarons + blueDragons + blueHeralds + blueKills, data=team_stats, family=binomial)
summary(model)
#Results give us a logit function, need to convert to individual winrate multipliers
oddMults = exp(coef(model)[-1])
oddMults
#Probability Conversion = Mults/1+mult Can build predictor model off of this
winrate = 0.5 #50% chance of winning a game
barons = -2
dragons = -1
heralds = 1
kills = 5
odds = winrate / (1 - winrate) * oddMults["blueBarons"]^barons * oddMults["blueDragons"]^dragons * oddMults["blueHeralds"]^heralds * oddMults["blueKills"]^kills

probability = odds/(1+odds)
probability
```


